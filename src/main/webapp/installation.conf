h1. 2. Installation


This document describes how to install and configure Apache Karaf for both Unix and Windows' platforms.
Here you will find information about what are pre requisite software, where to download Karaf from and how to customize the installation to use custom ports other than the defaults.

This article contains the following sections:
{toc:minLevel=2}

h2. Pre-Installation Requirements

*Hardware:*
* 5 MB of free disk space for the Apache Karaf x.y binary distribution.
* 3 MB of free disk space for the Apache Karaf x.y source distributions or SVN checkout. The Maven build requires roughly 57 MB disk space and for the dependencies Maven downloads during building further 76 MB are required. As a lot of small files are produced, the exact space demands depend greatly on your cluster utilization ratio.

*Operating Systems:*
* Windows: Windows XP SP2, Windows 2000.
* Unix: Ubuntu Linux, Powerdog Linux, MacOS, AIX, HP-UX, Solaris, any Unix platform that supports Java.

*Environment:*
* Java SE 1.5.x or greater ([http://www.oracle.com/technetwork/java/javase/]).
* The JAVA_HOME environment variable must be set to the directory where the Java runtime is installed, e.g., {{c:\Program Files\jdk.1.5.0_06}}. To accomplish that, press Windows key and Break key together, switch to "Advanced" tab and click on "Environment Variables". Here, check for the variable and, if necessary, add it.
* Apache Maven 2.0.9 ([http://maven.apache.org/download.html]).

h2. Installation Procedure for Windows

This section of the Getting Started guide explains how to install binary and source distributions of Karaf on a Windows system.
{tip:title=Handy Hint}
In case you have to install Karaf into a very deep path or a path containing illegal characters for Java paths, e.g. \!, % etc., you may add a bat file to _start \-> startup_ that executes
{noformat}
subst S: "C:\your very % problematic path!\KARAF"
{noformat}
so your Karaf root directory is S: --- which works for sure and is short to type.
{tip}

h3. Windows Binary Installation

This procedure explains how to download and install the binary distribution on a Windows system.
# From a browser, navigate to [http://karaf.apache.org/download.html].
# Scroll down to the "Apache Karaf" section and select the desired distribution.
For a binary distribution, the filename will be similar to: {{apache-karaf-x.y.zip}}.
# Extract the files from the ZIP file into a directory of your choice. Please remember the restrictions concerning illegal characters in Java paths, e.g. \!, % etc.
# Proceed to the [#Starting Karaf] section of this document.
# Following start-up, go to the [#Testing the Installation] section of this document.
# Optional: see [7.1. Enabling Colorized Console Output On Windows]

h3. Windows Source Installation

This procedure explains how to download and install the source distribution on a Windows system. *NOTE:* Karaf requires Java 5 is compile, build and run.
# From a browser, navigate to [http://karaf.apache.org/download.html].
# Scroll down to the "Apache Karaf" section and select the desired distribution.
For a source distribution, the filename will be similar to: {{apache-karaf-x.y-src.zip}}.
# Extract Karaf from the ZIP file into a directory of your choice. Please remember the restrictions concerning illegal characters in Java paths, e.g. \!, % etc.
# {anchor:Windows Source Installation} Build Karaf using Maven 2.0.9 or greater and Java 5.
The recommended method of building Karaf is the following:
{code}
cd [karaf_install_dir]\\src
{code}
 where {{\[karaf_install_dir\]}} is the directory in which Karaf was installed.
{code}
mvn
{code}
Both steps take around 10 to 15 minutes.
# Unzip the distribution using your favorite zip tool. The windows distribution is available at
{code}
\[karaf_install_dir\]\assembly\target\apache-karaf-x.y.zip
{code}
# Proceed to the [#Starting Karaf] section of this document.
# Following start-up, go to the [#Testing the Installation] section of this document.
# Optional: see [7.1. Enabling Colorized Console Output On Windows]

h2. Installation Procedure For Unix

h3. Unix Binary Installation

This procedure explains how to download and install the binary distribution on a Unix system.
# From a browser, navigate to [http://karaf.apache.org/download.html].
# Scroll down to the "Apache Karaf" section and select the desired distribution.
For a binary Unix distribution, the filename will be similar to: apache-karaf-x.y.tar.gz.
# Extract the files from the gzip file into a directory of your choice. For example:
{code}
gunzip apache-karaf-x.y.tar.gz
tar xvf apache-karaf-x.y.tar
{code}
Please remember the restrictions concerning illegal characters in Java paths, e.g. \!, % etc.
# Proceed to the [#Starting Karaf] section of this document.
# Following start-up, go to the [#Testing the Installation] section.

h3. Unix Source Installation

This procedure explains how to download and install the source distribution on a Unix system. This procedure assumes the Unix machine has a browser. Please see the previous [#Unix Binary Installation] section for ideas on how to install Karaf without a browser. *NOTE:* Karaf requires Java 5 to compile, build and run.
# From a browser, navigate to [http://karaf.apache.org/download.html].
# Scroll down to the "Apache Karaf" section and select the desired distribution.
For a source distribution, the filename will be similar to: {{apache-karaf-x.y-src.tar.gz}}.
# Extract the files from the ZIP file into a directory of your choice. For example:
{code}
gunzip apache-karaf-x.y-src.tar.gz
tar xvf apache-karaf-x.y-src.tar
{code}
Please remember the restrictions concerning illegal characters in Java paths, e.g. \!, % etc.
# Build Karaf using Maven 2.0.8 or greater and Java 5:
{code}
The preferred method of building Karaf is the following:
cd [karaf_install_dir]/src
 where [karaf_install_dir] is the directory in which Karaf was installed.
mvn
{code}
# Uncompress the distribution that has just been created
{code}
cd [karaf_install_dir]/assembly/target
gunzip apache-karaf-x.y.tar.gz
tar xvf apache-karaf-x.y.tar
{code}
# Proceed to the [#Starting Karaf] section of this document.
# Following start-up, go to the [#Testing the Installation] section.


h2. Starting Karaf


h3. On Windows

From a console window, change to the installation directory and run {{Karaf}}. For the binary distribution, go to
{code}
cd [karaf_install_dir]
{code}
and for the source distribution go to the target directory, for example:
{code}
cd [karaf_install_dir]\src\assembly\target\apache-karaf-x.y-SNAPSHOT
{code}
where {{karaf_install_dir}} is the directory in which Karaf was installed, e.g., {{c:\Program Files\apache-karaf-x.y}}.

Then type:
{code}
bin\karaf.bat
{code}
_Note:_ Working directories get created relative to the current directory. For the working directories to be created in the proper place, Karaf must be launched from its home/installation directory.

h3. On Unix

From a command shell, change to the installation directory and run {{Karaf}}. For the binary distribution, go to
{code}
cd [karaf_install_dir]
{code}
and for the source distribution go to the target directory, for example:
{code}
cd [karaf_install_dir]/src/assembly/target/apache-karaf-x.y
{code}
where {{karaf_install_dir}} is the directory in which Karaf was installed, e.g., {{/usr/local/apache-karaf-x.y}}.

Then type:
{code}
bin/karaf.sh
{code}

{warning:title=Warning}
Do NOT close the console or shell in which Karaf was started, as that will terminate Karaf (unless Karaf was started with nohup).
{warning}

h2. Testing the Installation

If Karaf is up and running without problems, the Window's console window or the Unix command shell will display something similar to the following log line:
{include:Karaf welcome screen}

h2. Stopping Karaf

For both Windows and Unix installations, you can perform a clean shutdown of Karaf by using the following command:
{code}
osgi:shutdown
{code}

If Karaf was started in the background on Unix, the process can be killed, with the following:
{code}
ps -ef | grep karaf
kill [PID]
 where [PID] is the process id of the Karaf process.
{code}
